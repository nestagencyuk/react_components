import { Meta, Story, Canvas, Preview, Props } from '@storybook/addon-docs/blocks'
import { Fragment, useContext, useState } from 'react'
import { useStateMachine } from '../../hooks/useStateMachine'
import { Text } from '../Text'
import { Button } from '../Button'
import { Float } from '../Float'
import { Alert } from '.'

<Meta title="Components|Base/Alert" component={Alert} />

# Alert
A simple alert for presenting Info, Success, Warning and Error messages to your users.

## Base
This is the alert in its most basic form, using all default props.

<Preview>
  <Story name="Base">
    <Alert header={{
      heading: 'Alert heading',
      size: 'Small'
    }}>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit
    </Alert>
  </Story>
</Preview>

## Variants
Pass a value to the `variant` prop to have your desired alert rendered.

`Info` is the default value, so the prop can be omitted.

### Info
<Preview>
  <Story name="Alert-Info">
    <Alert variant="Info" header={{
      heading: 'Info',
      size: 'Small',
    }}>
      Useful information.
    </Alert>
  </Story>
</Preview>

### Success
<Preview>
  <Story name="Alert-Success">
    <Alert variant="Success" header={{
      heading: 'Success',
      size: 'Small',
    }}>
       Wow, it worked!
    </Alert>
  </Story>
</Preview>

### Warning
<Preview>
  <Story name="Alert-Warning">
    <Alert variant="Warning" header={{
      heading: 'Warning',
      size: 'Small'
    }}>
      I'm warning you...
    </Alert>
  </Story>
</Preview>

### Error
<Preview>
  <Story name="Alert-Error">
    <Alert variant="Error" header={{
      heading: 'Error',
      size: 'Small'
    }}>
      There was an error!
    </Alert>
  </Story>
</Preview>

## Toggle
To create an alert popover, the base alert component can be combined with [Toggle](/?path=/docs/hooks-toggle--base) and [Float](/?path=/docs/layout-float--base).

<Preview>
  <Story name="Toggle">
    {() => {
      const [state, dispatchEvent] = useStateMachine()
      return (
        <Fragment>
          <Button onClick={() => dispatchEvent('OPEN')}>Open Alert</Button>
          <Float state={state} portal>
            <Alert onClose={() => dispatchEvent('CLOSE')}>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus lacinia turpis mattis justo pellentesque, ac vulputate felis dictum. Integer risus enim, posuere quis elementum non, commodo molestie odio.
            </Alert>
          </Float>
        </Fragment>
      )
    }}
  </Story>
</Preview>

## Timeout
Set a timeout so that the alert disappears after some time.

<Preview>
  <Story name="Alert-Timeout">
    {() => {
      const [state, dispatchEvent] = useStateMachine({ timeout: 3000 })
      return (
        <Fragment>
          <Button onClick={() => dispatchEvent('OPEN')}>Open Success Alert</Button>
          <Float state={state} portal>
            <Alert variant="Success">
              Wow, it worked!
            </Alert>
          </Float>
        </Fragment>
      )
    }}
  </Story>
</Preview>

## Confirm
An alert can be used to determine an action.

<Preview>
  <Story name="Confirm">
    {() => {
      const [decision, setDecision] = useState(null)
      const [state, dispatchEvent] = useStateMachine()
      return (
        <Fragment>
          <Button onClick={() => dispatchEvent('OPEN')}>Do something mad!</Button>
          {decision !== null && <Text>{decision ? 'Living on the wild side!' : 'Oh, :( boring'}</Text>}
          <Float state={state} portal>
            <Alert variant="Warning" footer={{
              actions: [
                { text: 'No', variant: 'Tertiary', size: 'Small', onClick: () => { setDecision(false); dispatchEvent('CLOSE') } },
                { text: 'Yes', variant: 'Primary', size: 'Small', onClick: () => { setDecision(true); dispatchEvent('CLOSE') } },
              ]
            }}>
              Are you sure you want to do this?!
            </Alert>
          </Float>
        </Fragment>
      )
    }}
  </Story>
</Preview>

## Prop Types
<Props of={Alert} />
