import { Meta, Story, Canvas, Preview, Props } from '@storybook/addon-docs/blocks'
import { useState, useEffect, Fragment } from 'react'
import { Text } from '../Text'
import { Loader } from '../Loader'
import { DataTable } from '.'
import { useStateMachine } from '../../hooks/useStateMachine'
import { loading } from '../../states'
import { testSKUS, testDescriptions, testUOMs, testQuantities, testBatch, testConfigStandard, withoutControlsConfig } from './DataTableConfig.ts'

<Meta title="Components|Data Table/Standard" component={DataTable} />

# Data Table
A table that accepts the same props as the [DataTable](/?path=/docs/components-data-table-form--base), but isn't editable.

## Base
The component in its simplest form.

<Preview>
  <Story name="Base">
    {() => {
      const [data, setData] = useState(testConfigStandard.data)
      const [loadingState, dispatchEvent] = useStateMachine({ machine: { ...loading, initial: 'Loading' } })
      const chance = new (require('chance'))()
      useEffect(() => {
        const fakeData = Array.from(Array(1000).keys()).map(x => ({
          product_sku: chance.pickone(testSKUS),
          product_description: chance.pickone(testDescriptions),
          unit_of_measure: chance.pickset(testUOMs, chance.integer({ min: 1, max: 5 })),
          quantity: chance.pickone(testQuantities),
          batch: chance.pickone(testBatch)
        }))
        setTimeout(() => {
          setData(fakeData)
          dispatchEvent('SUCCESS')
        }, 3000)
      }, [])
      return (
        <Fragment>
          <DataTable
            loadingState={loadingState}
            controls={testConfigStandard.controls}
            header={testConfigStandard.header} 
            rows={testConfigStandard.rows}
            data={data}
          />
          <div style={{ marginBottom: '50px' }} />
        </Fragment>
      )
    }}
  </Story>
</Preview>

## Without controls
This table has no global, row or footer controls rendered, making it a basic table.

<Preview>
  <Story name="Without Controls">
    {() => {
      const [data, setData] = useState(testConfigStandard.data)
      const [loadingState, dispatchEvent] = useStateMachine({ machine: { ...loading, initial: 'Loading' } })
      const chance = new (require('chance'))()
      useEffect(() => {
        const fakeData = Array.from(Array(1000).keys()).map(x => ({
          product_sku: chance.pickone(testSKUS),
          product_description: chance.pickone(testDescriptions),
          unit_of_measure: chance.pickset(testUOMs, chance.integer({ min: 1, max: 5 })),
          quantity: chance.pickone(testQuantities),
          batch: chance.pickone(testBatch)
        }))
        setTimeout(() => {
          setData(fakeData)
          dispatchEvent('SUCCESS')
        }, 3000)
      }, [])
      return (
        <Fragment>
          <DataTable
            loadingState={loadingState}
            controls={withoutControlsConfig.controls}
            header={withoutControlsConfig.header} 
            rows={withoutControlsConfig.rows}
            data={data}
          />
          <div style={{ marginBottom: '50px' }} />
        </Fragment>
      )
    }}
  </Story>
</Preview>