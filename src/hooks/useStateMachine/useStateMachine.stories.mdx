import { Meta, Story, Canvas, Preview, Props } from '@storybook/addon-docs/blocks'
import { Fragment, useContext, useState } from 'react'
import { opening } from '../../states'
import { Text } from '../../components/Text'
import { Button } from '../../components/Button'
import { useStateMachine } from '.'

<Meta title="Hooks|State Machine" component={null} />

# State Machine
A hook that provides a finite state machine to have more control over a component's state than a [Toggle](/?path=/docs/hooks-toggle--base) would provide.
 
## Base
The hook in its simplest form. The default state machine is optimised for an opening & closing effect:

```js
const opening = {
  initial: 'Closed',
  states: {
    Closed: {
      on: {
        OPEN: 'Opening'
      }
    },
    Opening: {
      next: 'Open'
    },
    Open: {
      on: {
        CLOSE: 'Closing'
      }
    },
    Closing: {
      next: 'Closed'
    }
  }
}
```

<Preview>
  <Story name="Base">
    {() => {
      const [state, dispatchEvent] = useStateMachine({ machine: opening })
      return (
        <Fragment>
          <Text>{state}</Text>
          <Button onClick={() => dispatchEvent(state === 'Open' ? 'CLOSE' : 'OPEN')}>{state === 'Open' ? 'Untoggle' : 'Toggle me!'}</Button>
        </Fragment>
      )
    }}
  </Story>
</Preview>