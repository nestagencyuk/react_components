import { Meta, Story, Canvas, Preview, Props } from '@storybook/addon-docs/blocks'
import { RefDiv, RefSection } from '../../../.storybook/helpers'
import { Fragment, useContext, useState, useRef, forwardRef } from 'react'
import { RefBox } from '../../components/Box'
import { Select } from '../../components/Select'
import { Button } from '../../components/Button'
import { Field } from '../../components/Field'
import { Text } from '../../components/Text'
import { useFocus } from '.'

<Meta title="Hooks|Focus" />

# Focus
A hook for checking to see if a particular element is focused or not.

## Base
The hook in its simplest form. Behaviour is similar to CSS `:focus-within`.

<Preview>
  <Story name="Base">
    {() => {
      const [value, setValue] = useState(false)
      const [focused, onFocus, onBlur] = useFocus()
      return (
        <RefSection className="p--md bg--ui-one" style={{ border: 'solid 1px #f3f3f3'}} tabIndex={-1} onFocus={onFocus} onBlur={onBlur}>
          <Text variant="Intro">{focused ? 'Focused' : 'Unfocused'}</Text>
          
          {focused && (
            <Fragment>
              <Text>Some text</Text>
              <Select options={[{ value: 'test', label: 'Test' }]} value={value} onChange={setValue} />
              <Field id="checkbox" label="Test" type="Checkbox" value={value} onChange={setValue} />
              <Button onClick={() => console.log('Click!')}>Button</Button>
            </Fragment>
          )}
        </RefSection>
      )
    }}
  </Story>
</Preview>

## Unrelated Elements
To connect a `trigger` and a `target` to toggle elements that aren't related in the DOM, add the `onBlur` to the unrelated target element too. Useful for tooltips.

<Preview>
  <Story name="Outside">
    {() => {
      const [trigger, setTrigger] = useState(null)
      const [target, setTarget] = useState(null)
      const [value, setValue] = useState(false)
      const [focused, onFocus, onBlur] = useFocus({ trigger, target })
      return (
        <Fragment>
          <RefSection ref={setTrigger} onFocus={onFocus} onBlur={onBlur}>
            <Button onClick={() => console.log('Click!')}>{focused ? 'Focused' : 'Unfocused'}</Button>
          </RefSection>
          <br />
          {focused && (
            <RefDiv ref={setTarget} className="p--md bg--ui-one" tabIndex={-1} onBlur={onBlur}>
              Some text
              <Select options={[{ value: 'test', label: 'Test' }]} value={value} onChange={setValue} />
              <Field id="checkbox" label="Test" type="Checkbox" value={value} onChange={setValue} />
              <Button onClick={() => console.log('Click!')}>Button</Button>
            </RefDiv>
          )}
        </Fragment>
      )
    }}
  </Story>
</Preview>

